namespace = giga_katzen_colonyship

#######################################################
### Katerise ##########################################
#######################################################
# Entered system, encountered colony ship
ship_event = {
	id = giga_katzen_colonyship.100
	title = "giga_katzen_colonyship.100.name"
	desc = "giga_katzen_colonyship.100.desc"
	picture = GFX_evt_space_debris
	show_sound = event_air_raid_siren
	location = from
	is_triggered_only = yes

	trigger = {
		owner = { 
			NOT = { has_country_flag = encountered_meopa_expedition_4 }
		}
		from = {
			has_star_flag = katerise_system
		}
	}

	immediate = { owner = { set_country_flag = encountered_meopa_expedition_4 } }
	option = { name = "giga_katzen_colonyship.100.a" }
}

## Killed the ship
# This = owner of ship 1 (combatant)
# From = owner of ship 2 (destroyed)
# FromFrom = ship 1
# FromFromFrom = ship 2
country_event = {
	id = giga_katzen_colonyship.101
	title = "giga_katzen_colonyship.101.title"
	desc = "giga_katzen_colonyship.101.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_alien_signal
	is_triggered_only = yes

	trigger = {
		has_country_flag = encountered_meopa_expedition_4
		fromfromfrom = { is_ship_size = giga_meopa_expedition }
	}

	immediate = {
		fromfromfrom = { solar_system = { save_event_target_as = katerise_system } }
		create_ambient_object = { type = "giga_meopa_expedition_broken_object" location = fromfromfrom }
		last_created_ambient_object = {
			save_event_target_as = giga_meopa_expedition_broken
			set_ambient_object_flag = giga_meopa_expedition_broken
		}
		from = { destroy_country = yes }
	}

	# repair option not implemented
	#option = {
	#	name = "giga_katzen_colonyship.101.a"
	#	event_target:eeloo_broken = {
	#		enable_special_project = {
	#			name = "REPAIR_EELOO_PROJECT"
	#			location = this
	#			owner = root
	#		}
	#	}
	#	hidden_effect = { set_country_flag = defeated_giga_eeloo }
	#}

	option = {
		name = "giga_katzen_colonyship.101.b"
		add_resource = { minerals = 10000 }
		add_resource = { alloys = 2500 }
		hidden_effect = {
			set_country_flag = defeated_giga_meopa_expedition_4
		}
	}
}

# Survey, Ezicania
ship_event = {
	id = giga_katzen_colonyship.200
	title = "giga_katzen_colonyship.200.name"
	desc = "giga_katzen_colonyship.200.desc"
	picture = GFX_evt_alien_cavemen
	show_sound = event_ghost_town
	location = from
	is_triggered_only = yes
	trigger = { 
		# EHOF version should only trigger after doing Katzenland digsite, both system spawning and events related to it
		#owner = { has_country_flag = found_katzenland_katzens }
		from = { has_planet_flag = forrana }
	}

	option = {
		name = "giga_katzen_colonyship.200.a"
	}
}

# Survey, Katerise
ship_event = {
	id = giga_katzen_colonyship.001
	title = "giga_katzen_colonyship.001.name"
	desc = "giga_katzen_colonyship.001.desc"
	picture = GFX_evt_relic_world_street
	show_sound = event_ghost_town
	location = from
	is_triggered_only = yes
	trigger = { 
		# EHOF version should only trigger after doing Katzenland digsite, both system spawning and events related to it
		#owner = { has_country_flag = found_katzenland_katzens }
		from = { has_planet_flag = katerise } 
	}

	option = {
		name = "giga_katzen_colonyship.001.a"
		hidden_effect = { from = { create_archaeological_site = site_katerise } }
	}
}

# First dig site, Katzen Skeletons
fleet_event = {
	id = giga_katzen_colonyship.002
	title = "giga_katzen_colonyship.002.name"
	desc = "giga_katzen_colonyship.002.desc"
	picture = GFX_evt_landing_ship
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.002.a"
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Second dig site, Buried Data Core
fleet_event = {
	id = giga_katzen_colonyship.003
	title = "giga_katzen_colonyship.003.name"
	desc = "giga_katzen_colonyship.003.desc"
	picture = GFX_evt_ancient_records
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.003.a"
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Third dig site, Katzen Monument
fleet_event = {
	id = giga_katzen_colonyship.004
	title = "giga_katzen_colonyship.004.name"
	desc = "giga_katzen_colonyship.004.desc"
	picture = GFX_evt_relic_world_building
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.004.a"
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier4researchreward
				min = @tier4researchmin
				max = @tier4researchmax
			}
		}
	}
}

# Fourth dig site, Meopa's Legacy
fleet_event = {
	id = giga_katzen_colonyship.005
	title = "giga_katzen_colonyship.005.name"
	desc = "giga_katzen_colonyship.005.desc"
	picture = GFX_evt_resource_cache
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.005.a"
		owner = {
			add_resource = { rare_crystals = 150 }
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Fifth dig site, Capital Archives
fleet_event = {
	id = giga_katzen_colonyship.006
	title = "giga_katzen_colonyship.006.name"
	desc = "giga_katzen_colonyship.006.desc"
	picture = GFX_evt_ancient_databank
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.006.a"
		owner = {
			small_artifact_reward = yes
			add_resource = { energy = 500 }
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier4researchreward
				min = @tier4researchmin
				max = @tier4researchmax
			}
		}
	}
}

# Sixth dig site, History Repeats
fleet_event = {
	id = giga_katzen_colonyship.007
	title = "giga_katzen_colonyship.007.name"
	desc = "giga_katzen_colonyship.007.desc"
	picture = GFX_evt_nuclear_explosion
	archaeology = yes
	show_sound = event_dig_site
	is_triggered_only = yes

	immediate = {	fromfrom = { set_site_progress_locked = yes } }
	after = {		fromfrom = { set_site_progress_locked = no } }

	option = {
		name = "giga_katzen_colonyship.007.a"
		trigger = {
			owner = {
				NOT = { has_country_flag = found_flusion_katzens }
			}
		}
		owner = {
			# way to get Katzenland bombardment without nuking Flusion
			hidden_effect = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_militarist
							has_ethic = ethic_fanatic_militarist
							has_ethic = ethic_fanatic_xenophobe
							has_valid_civic = civic_fanatic_purifiers
							has_valid_civic = civic_hive_devouring_swarm
							has_valid_civic = civic_machine_terminator
						}
					}
					country_event = { id = giga_flusion.005 days = 60 random = 10 } #Reverse-engineer Katzen nuking
				}
			}

			set_country_flag = found_katerise_katzens
			small_artifact_reward = yes
			if = {
				limit = {
					NOT = { has_technology = giga_tech_terraform_barren }
				}
				add_research_option = giga_tech_terraform_barren
				add_tech_progress = {
					tech = giga_tech_terraform_barren
					progress = 0.25
				}
			}
			add_modifier = {
				modifier = katzenland_terraform_knowledge
				days = -1
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier5researchreward
				min = @tier5researchmin
				max = @tier5researchmax
			}
		}
	}

	option = {
		name = "giga_katzen_colonyship.007.b"
		trigger = {
			owner = {
				has_country_flag = found_flusion_katzens
				NOT = { has_country_flag = flusion_katzens_nuked }
			}
		}
		owner = {
			# way to get Katzenland bombardment without nuking Flusion
			hidden_effect = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_militarist
							has_ethic = ethic_fanatic_militarist
							has_ethic = ethic_fanatic_xenophobe
							has_valid_civic = civic_fanatic_purifiers
							has_valid_civic = civic_hive_devouring_swarm
							has_valid_civic = civic_machine_terminator
						}
					}
					country_event = { id = giga_flusion.005 days = 60 random = 10 } #Reverse-engineer Katzen nuking
				}
			}

			set_country_flag = found_katerise_katzens
			small_artifact_reward = yes
			if = {
				limit = {
					NOT = { has_technology = giga_tech_terraform_barren }
				}
				add_research_option = giga_tech_terraform_barren
				add_tech_progress = {
					tech = giga_tech_terraform_barren
					progress = 0.25
				}
			}
			add_modifier = {
				modifier = katzenland_terraform_knowledge
				days = -1
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier5researchreward
				min = @tier5researchmin
				max = @tier5researchmax
			}
		}
	}

	option = {
		name = "giga_katzen_colonyship.007.b"
		trigger = {
			owner = {
				has_country_flag = found_flusion_katzens
				has_country_flag = flusion_katzens_nuked
			}
		}
		owner = {
			set_country_flag = found_katerise_katzens
			small_artifact_reward = yes
			if = {
				limit = {
					NOT = { has_technology = giga_tech_terraform_barren }
				}
				add_research_option = giga_tech_terraform_barren
				add_tech_progress = {
					tech = giga_tech_terraform_barren
					progress = 0.25
				}
			}
			add_modifier = {
				modifier = katzenland_terraform_knowledge
				days = -1
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier5researchreward
				min = @tier5researchmin
				max = @tier5researchmax
			}
		}
	}
}

